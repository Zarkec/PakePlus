import{n as I,I as Pe,d as qe,r as v,a as pe,p as Oe,b as W,e as c,f as s,w as d,i as A,g as V,u as B,J as Je,K as Ge,z as He,L as Ke,F as ge,B as me,M as Qe,D as he,s as Xe,v as Ye,x as O,t as N,N as Ze,C as ke,O as et,G as we,P as Ce,Q as tt,m as _,H as at,o as C}from"./index-CCQ4VAXS.js";import{_ as lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";class S{static getConfigList(y){return I.get("/v1/configs",{params:y})}static getConfigDetail(y,p=!1){return I.get(`/v1/configs/${y}`,{params:{include_file:p}})}static createConfig(y){return I.post("/v1/configs",y)}static createConfigWithFile(y){return I.post("/v1/configs",y,{headers:{"Content-Type":"multipart/form-data"}})}static updateConfig(y,p){return I.put(`/v1/configs/${y}`,p)}static updateConfigWithFile(y,p){return I.put(`/v1/configs/${y}`,p,{headers:{"Content-Type":"multipart/form-data"}})}static deleteConfig(y){return I.delete(`/v1/configs/${y}`)}static saveFileContent(y,p,J){const b=new FormData,G=new Blob([p],{type:"text/plain"});return b.append("file",G,J),I.put(`/v1/configs/${y}`,b,{headers:{"Content-Type":"multipart/form-data"}})}static downloadConfigs(y){return I.post("/v1/configs/download",{ids:y},{responseType:"blob"})}static batchCreateConfigs(y){return I.post("/v1/configs/batch",y,{headers:{"Content-Type":"multipart/form-data"}})}static getProjectList(){return I.get("/v1/configs/projects")}}var Ve={exports:{}};(function(se,y){(function(p){se.exports=p()})(function(p){var J=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function b(r,n){var t=r[0],e=r[1],l=r[2],a=r[3];t+=(e&l|~e&a)+n[0]-680876936|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&l)+n[1]-389564586|0,a=(a<<12|a>>>20)+t|0,l+=(a&t|~a&e)+n[2]+606105819|0,l=(l<<17|l>>>15)+a|0,e+=(l&a|~l&t)+n[3]-1044525330|0,e=(e<<22|e>>>10)+l|0,t+=(e&l|~e&a)+n[4]-176418897|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&l)+n[5]+1200080426|0,a=(a<<12|a>>>20)+t|0,l+=(a&t|~a&e)+n[6]-1473231341|0,l=(l<<17|l>>>15)+a|0,e+=(l&a|~l&t)+n[7]-45705983|0,e=(e<<22|e>>>10)+l|0,t+=(e&l|~e&a)+n[8]+1770035416|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&l)+n[9]-1958414417|0,a=(a<<12|a>>>20)+t|0,l+=(a&t|~a&e)+n[10]-42063|0,l=(l<<17|l>>>15)+a|0,e+=(l&a|~l&t)+n[11]-1990404162|0,e=(e<<22|e>>>10)+l|0,t+=(e&l|~e&a)+n[12]+1804603682|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&l)+n[13]-40341101|0,a=(a<<12|a>>>20)+t|0,l+=(a&t|~a&e)+n[14]-1502002290|0,l=(l<<17|l>>>15)+a|0,e+=(l&a|~l&t)+n[15]+1236535329|0,e=(e<<22|e>>>10)+l|0,t+=(e&a|l&~a)+n[1]-165796510|0,t=(t<<5|t>>>27)+e|0,a+=(t&l|e&~l)+n[6]-1069501632|0,a=(a<<9|a>>>23)+t|0,l+=(a&e|t&~e)+n[11]+643717713|0,l=(l<<14|l>>>18)+a|0,e+=(l&t|a&~t)+n[0]-373897302|0,e=(e<<20|e>>>12)+l|0,t+=(e&a|l&~a)+n[5]-701558691|0,t=(t<<5|t>>>27)+e|0,a+=(t&l|e&~l)+n[10]+38016083|0,a=(a<<9|a>>>23)+t|0,l+=(a&e|t&~e)+n[15]-660478335|0,l=(l<<14|l>>>18)+a|0,e+=(l&t|a&~t)+n[4]-405537848|0,e=(e<<20|e>>>12)+l|0,t+=(e&a|l&~a)+n[9]+568446438|0,t=(t<<5|t>>>27)+e|0,a+=(t&l|e&~l)+n[14]-1019803690|0,a=(a<<9|a>>>23)+t|0,l+=(a&e|t&~e)+n[3]-187363961|0,l=(l<<14|l>>>18)+a|0,e+=(l&t|a&~t)+n[8]+1163531501|0,e=(e<<20|e>>>12)+l|0,t+=(e&a|l&~a)+n[13]-1444681467|0,t=(t<<5|t>>>27)+e|0,a+=(t&l|e&~l)+n[2]-51403784|0,a=(a<<9|a>>>23)+t|0,l+=(a&e|t&~e)+n[7]+1735328473|0,l=(l<<14|l>>>18)+a|0,e+=(l&t|a&~t)+n[12]-1926607734|0,e=(e<<20|e>>>12)+l|0,t+=(e^l^a)+n[5]-378558|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^l)+n[8]-2022574463|0,a=(a<<11|a>>>21)+t|0,l+=(a^t^e)+n[11]+1839030562|0,l=(l<<16|l>>>16)+a|0,e+=(l^a^t)+n[14]-35309556|0,e=(e<<23|e>>>9)+l|0,t+=(e^l^a)+n[1]-1530992060|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^l)+n[4]+1272893353|0,a=(a<<11|a>>>21)+t|0,l+=(a^t^e)+n[7]-155497632|0,l=(l<<16|l>>>16)+a|0,e+=(l^a^t)+n[10]-1094730640|0,e=(e<<23|e>>>9)+l|0,t+=(e^l^a)+n[13]+681279174|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^l)+n[0]-358537222|0,a=(a<<11|a>>>21)+t|0,l+=(a^t^e)+n[3]-722521979|0,l=(l<<16|l>>>16)+a|0,e+=(l^a^t)+n[6]+76029189|0,e=(e<<23|e>>>9)+l|0,t+=(e^l^a)+n[9]-640364487|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^l)+n[12]-421815835|0,a=(a<<11|a>>>21)+t|0,l+=(a^t^e)+n[15]+530742520|0,l=(l<<16|l>>>16)+a|0,e+=(l^a^t)+n[2]-995338651|0,e=(e<<23|e>>>9)+l|0,t+=(l^(e|~a))+n[0]-198630844|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~l))+n[7]+1126891415|0,a=(a<<10|a>>>22)+t|0,l+=(t^(a|~e))+n[14]-1416354905|0,l=(l<<15|l>>>17)+a|0,e+=(a^(l|~t))+n[5]-57434055|0,e=(e<<21|e>>>11)+l|0,t+=(l^(e|~a))+n[12]+1700485571|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~l))+n[3]-1894986606|0,a=(a<<10|a>>>22)+t|0,l+=(t^(a|~e))+n[10]-1051523|0,l=(l<<15|l>>>17)+a|0,e+=(a^(l|~t))+n[1]-2054922799|0,e=(e<<21|e>>>11)+l|0,t+=(l^(e|~a))+n[8]+1873313359|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~l))+n[15]-30611744|0,a=(a<<10|a>>>22)+t|0,l+=(t^(a|~e))+n[6]-1560198380|0,l=(l<<15|l>>>17)+a|0,e+=(a^(l|~t))+n[13]+1309151649|0,e=(e<<21|e>>>11)+l|0,t+=(l^(e|~a))+n[4]-145523070|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~l))+n[11]-1120210379|0,a=(a<<10|a>>>22)+t|0,l+=(t^(a|~e))+n[2]+718787259|0,l=(l<<15|l>>>17)+a|0,e+=(a^(l|~t))+n[9]-343485551|0,e=(e<<21|e>>>11)+l|0,r[0]=t+r[0]|0,r[1]=e+r[1]|0,r[2]=l+r[2]|0,r[3]=a+r[3]|0}function G(r){var n=[],t;for(t=0;t<64;t+=4)n[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return n}function D(r){var n=[],t;for(t=0;t<64;t+=4)n[t>>2]=r[t]+(r[t+1]<<8)+(r[t+2]<<16)+(r[t+3]<<24);return n}function H(r){var n=r.length,t=[1732584193,-271733879,-1732584194,271733878],e,l,a,w,$,R;for(e=64;e<=n;e+=64)b(t,G(r.substring(e-64,e)));for(r=r.substring(e-64),l=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<l;e+=1)a[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(b(t,a),e=0;e<16;e+=1)a[e]=0;return w=n*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),$=parseInt(w[2],16),R=parseInt(w[1],16)||0,a[14]=$,a[15]=R,b(t,a),t}function Q(r){var n=r.length,t=[1732584193,-271733879,-1732584194,271733878],e,l,a,w,$,R;for(e=64;e<=n;e+=64)b(t,D(r.subarray(e-64,e)));for(r=e-64<n?r.subarray(e-64):new Uint8Array(0),l=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<l;e+=1)a[e>>2]|=r[e]<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(b(t,a),e=0;e<16;e+=1)a[e]=0;return w=n*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),$=parseInt(w[2],16),R=parseInt(w[1],16)||0,a[14]=$,a[15]=R,b(t,a),t}function P(r){var n="",t;for(t=0;t<4;t+=1)n+=J[r>>t*8+4&15]+J[r>>t*8&15];return n}function U(r){var n;for(n=0;n<r.length;n+=1)r[n]=P(r[n]);return r.join("")}U(H("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function r(n,t){return n=n|0||0,n<0?Math.max(n+t,0):Math.min(n,t)}ArrayBuffer.prototype.slice=function(n,t){var e=this.byteLength,l=r(n,e),a=e,w,$,R,ne;return t!==p&&(a=r(t,e)),l>a?new ArrayBuffer(0):(w=a-l,$=new ArrayBuffer(w),R=new Uint8Array($),ne=new Uint8Array(this,l,w),R.set(ne),$)}}();function X(r){return/[\u0080-\uFFFF]/.test(r)&&(r=unescape(encodeURIComponent(r))),r}function Z(r,n){var t=r.length,e=new ArrayBuffer(t),l=new Uint8Array(e),a;for(a=0;a<t;a+=1)l[a]=r.charCodeAt(a);return n?l:e}function q(r){return String.fromCharCode.apply(null,new Uint8Array(r))}function f(r,n,t){var e=new Uint8Array(r.byteLength+n.byteLength);return e.set(new Uint8Array(r)),e.set(new Uint8Array(n),r.byteLength),e}function j(r){var n=[],t=r.length,e;for(e=0;e<t-1;e+=2)n.push(parseInt(r.substr(e,2),16));return String.fromCharCode.apply(String,n)}function h(){this.reset()}return h.prototype.append=function(r){return this.appendBinary(X(r)),this},h.prototype.appendBinary=function(r){this._buff+=r,this._length+=r.length;var n=this._buff.length,t;for(t=64;t<=n;t+=64)b(this._hash,G(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},h.prototype.end=function(r){var n=this._buff,t=n.length,e,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;for(e=0;e<t;e+=1)l[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(l,t),a=U(this._hash),r&&(a=j(a)),this.reset(),a},h.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},h.prototype.setState=function(r){return this._buff=r.buff,this._length=r.length,this._hash=r.hash,this},h.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},h.prototype._finish=function(r,n){var t=n,e,l,a;if(r[t>>2]|=128<<(t%4<<3),t>55)for(b(this._hash,r),t=0;t<16;t+=1)r[t]=0;e=this._length*8,e=e.toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(e[2],16),a=parseInt(e[1],16)||0,r[14]=l,r[15]=a,b(this._hash,r)},h.hash=function(r,n){return h.hashBinary(X(r),n)},h.hashBinary=function(r,n){var t=H(r),e=U(t);return n?j(e):e},h.ArrayBuffer=function(){this.reset()},h.ArrayBuffer.prototype.append=function(r){var n=f(this._buff.buffer,r),t=n.length,e;for(this._length+=r.byteLength,e=64;e<=t;e+=64)b(this._hash,D(n.subarray(e-64,e)));return this._buff=e-64<t?new Uint8Array(n.buffer.slice(e-64)):new Uint8Array(0),this},h.ArrayBuffer.prototype.end=function(r){var n=this._buff,t=n.length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l,a;for(l=0;l<t;l+=1)e[l>>2]|=n[l]<<(l%4<<3);return this._finish(e,t),a=U(this._hash),r&&(a=j(a)),this.reset(),a},h.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.ArrayBuffer.prototype.getState=function(){var r=h.prototype.getState.call(this);return r.buff=q(r.buff),r},h.ArrayBuffer.prototype.setState=function(r){return r.buff=Z(r.buff,!0),h.prototype.setState.call(this,r)},h.ArrayBuffer.prototype.destroy=h.prototype.destroy,h.ArrayBuffer.prototype._finish=h.prototype._finish,h.ArrayBuffer.hash=function(r,n){var t=Q(new Uint8Array(r)),e=U(t);return n?j(e):e},h})})(Ve);var nt=Ve.exports;const ot=Pe(nt),rt={class:"config-management-container"},st={class:"content-card"},it={class:"card-header"},ut={class:"action-bar"},dt={class:"tab-container"},ct={class:"filter-bar"},ft={class:"filter-group"},pt={class:"filter-group"},gt={class:"filter-group"},mt={class:"filter-group"},ht={class:"filter-buttons"},vt={class:"table-container"},_t={class:"data-cell id-cell"},yt={class:"data-cell product-cell"},bt={class:"data-cell project-cell"},wt={key:1},Ct={class:"data-cell time-cell"},Vt={class:"data-cell time-cell"},At={class:"tag-content"},jt={class:"tag-text"},xt={class:"button-group-horizontal"},Bt={class:"pagination"},Ft={key:0,class:"selected-file-info"},Ut={class:"file-name"},St={class:"dialog-footer"},Dt={class:"batch-upload-container"},$t={class:"dialog-footer"},Lt={key:0,class:"editor-loading"},zt={key:1,class:"editor-error"},Mt={key:2,class:"editor-container"},It={class:"dialog-footer"},Rt=qe({__name:"ConfigManagement",setup(se){const y=v("active"),p=pe({product:"",project:"",filename:"",tag:"",is_deleted:0}),J=v([]),b=v(!1),G=v(0),D=v(1),H=v(10),Q=v([]),P=v(!1),U=v("create"),X=v(),Z=v(!1),q=v(null),f=pe({product:"",project:"",filename:"",tag:"",md5:""}),j=v(null),h={product:[{required:!0,message:"请输入产品名称",trigger:"blur"},{max:100,message:"长度不能超过100个字符",trigger:"blur"}],project:[{required:!0,message:"请输入项目名称",trigger:"blur"},{max:100,message:"长度不能超过100个字符",trigger:"blur"}],filename:[{required:!0,message:"请输入文件名",trigger:"blur"},{max:255,message:"长度不能超过255个字符",trigger:"blur"}],tag:[{max:100,message:"长度不能超过100个字符",trigger:"blur"}],md5:[{required:!0,message:"请输入MD5值",trigger:"blur"},{pattern:/^[a-fA-F0-9]{32}$/,message:"MD5值格式不正确",trigger:"blur"}]},r=u=>{u==="active"?p.is_deleted=0:p.is_deleted=1,D.value=1,n()},n=async()=>{b.value=!0;try{const u={page:D.value,page_size:H.value};p.product&&(u.product=p.product),p.project&&(u.project=p.project),p.filename&&(u.filename=p.filename),p.tag&&(u.tag=p.tag),u.is_deleted=p.is_deleted;const o=await S.getConfigList(u);J.value=o.items,G.value=o.total}catch(u){console.error("获取配置文件列表失败:",u),_.error("获取配置文件列表失败")}finally{b.value=!1}},t=u=>{D.value=u,n()},e=u=>{H.value=u,D.value=1,n()},l=()=>{D.value=1,n()},a=()=>{p.product="",p.project="",p.filename="",p.tag="",D.value=1,n()},w=()=>{n()},$=()=>{U.value="create",q.value=null,f.product="",f.project="",f.filename="",f.tag="",f.md5="",P.value=!0},R=u=>{U.value="edit",q.value=u.id,f.product=u.product,f.project=u.project,f.filename=u.filename,f.tag=u.tag||"",f.md5=u.md5,P.value=!0},ne=u=>{const o=u.is_deleted===0,g=o?"删除":"恢复";at.confirm(`确定要${g}配置文件 "${u.filename}" 吗？`,`${g}确认`,{confirmButtonText:"确定",cancelButtonText:"取消",type:o?"warning":"info"}).then(async()=>{try{o?(await S.deleteConfig(u.id),_.success("配置文件删除成功")):(await S.updateConfig(u.id,{is_deleted:0}),_.success("配置文件恢复成功")),n()}catch(m){console.error(`${g}失败:`,m),_.error(`${g}失败`)}}).catch(()=>{})},Ae=async()=>{X.value&&await X.value.validate(async u=>{if(u){if(U.value==="create"&&!j.value&&!f.md5){_.error("请上传配置文件或输入MD5值");return}Z.value=!0;try{if(j.value&&j.value.raw){const o=new FormData;o.append("file",j.value.raw),o.append("product",f.product),o.append("project",f.project),o.append("filename",f.filename),f.tag&&o.append("tag",f.tag),f.md5&&o.append("md5",f.md5),U.value==="create"?(await S.createConfigWithFile(o),_.success("配置文件创建成功")):q.value&&(await S.updateConfigWithFile(q.value,o),_.success("配置文件更新成功"))}else{const o={product:f.product,project:f.project,filename:f.filename,md5:f.md5};f.tag&&(o.tag=f.tag),U.value==="create"?(await S.createConfig(o),_.success("配置文件创建成功")):q.value&&(await S.updateConfig(q.value,o),_.success("配置文件更新成功"))}P.value=!1,n()}catch(o){console.error("操作失败:",o),_.error("操作失败")}finally{Z.value=!1}}})},je=u=>{j.value=u,u.name&&(f.filename=u.name,u.raw&&Be(u.raw))},xe=()=>{j.value=null,f.filename="",f.md5=""},Be=async u=>{try{let o=function(){const F=z*g,T=Math.min(F+g,u.size);x.readAsArrayBuffer(u.slice(F,T))};const g=2097152,m=Math.ceil(u.size/2097152);let z=0;const M=new ot.ArrayBuffer,x=new FileReader;x.onload=F=>{F.target&&F.target.result&&(M.append(F.target.result),z++,z<m?o():f.md5=M.end())},x.onerror=()=>{_.error("MD5计算失败")},o()}catch(o){console.error("MD5计算失败:",o),_.error("MD5计算失败")}},oe=v([]),ie=v(!1),Fe=u=>{oe.value=u},Ue=async()=>{if(oe.value.length===0){_.warning("请至少选择一个配置文件");return}ie.value=!0;try{const u=oe.value.map(M=>M.id),o=await S.downloadConfigs(u);if(o instanceof Blob&&o.type.toLowerCase().includes("application/json")){const M=new FileReader;M.onload=async x=>{var F;try{const T=JSON.parse((F=x.target)==null?void 0:F.result);T&&T.message?_.error(`下载失败: ${T.message}`):_.error("下载失败: 服务器返回了无效的响应")}catch{_.error("下载失败: 无法解析服务器响应")}},M.readAsText(o);return}const g=window.URL.createObjectURL(o),m=document.createElement("a");m.href=g;const z=new Date().getTime();m.download=`configs_${z}.zip`,document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(g),document.body.removeChild(m),_.success("配置文件下载成功")}catch(u){console.error("下载配置文件失败:",u),_.error(`下载配置文件失败: ${u instanceof Error?u.message:"未知错误"}`)}finally{ie.value=!1}},k=v(!1),Se=v(),ue=v(!1),ee=v([]),te=v([]),L=pe({project:"",tag:""}),De=()=>{k.value=!0,L.project="",L.tag="",ee.value=[],te.value=[]},$e=(u,o)=>{if(ee.value=o,u.name){const g=u.name,m=g.split(".")[0];te.value.findIndex(M=>M.product===m)===-1&&te.value.push({product:m,filename:g})}},Le=u=>{if(u.name){const o=u.name.split(".")[0],g=te.value.findIndex(m=>m.product===o);g!==-1&&te.value.splice(g,1)}},ze=async()=>{if(!L.project){_.error("请选择项目");return}if(ee.value.length===0){_.error("请至少上传一个配置文件");return}ue.value=!0;try{const u=new FormData;u.append("project",L.project),L.tag&&u.append("tag",L.tag),ee.value.forEach((g,m)=>{if(g.raw){u.append("files[]",g.raw);const z=g.name.split(".")[0];u.append(`products[${m}]`,z)}});const o=await S.batchCreateConfigs(u);_.success(`批量添加成功，成功添加${o.success}个配置文件，失败${o.failed}个`),k.value=!1,n()}catch(u){console.error("批量添加失败:",u),_.error("批量添加失败")}finally{ue.value=!1}},ae=v(!1),le=v(""),de=v(!1),ce=v(!1),Y=v(""),re=v(null),Me=async u=>{re.value=u,ae.value=!0,de.value=!0,Y.value="",le.value="";try{const o=await S.getConfigDetail(u.id,!0);o.file_error?Y.value=o.file_error:o.file_content!==void 0?le.value=o.file_content:Y.value="无法获取文件内容"}catch(o){console.error("获取文件内容失败:",o),Y.value="获取文件内容失败"}finally{de.value=!1}},Ie=async()=>{if(re.value){ce.value=!0;try{await S.saveFileContent(re.value.id,le.value,re.value.filename),_.success("文件内容保存成功"),ae.value=!1,n()}catch(u){console.error("保存文件内容失败:",u),_.error("保存文件内容失败")}finally{ce.value=!1}}},Re=async()=>{try{const u=await S.getProjectList();Q.value=u||[]}catch(u){console.error("获取项目列表失败:",u),_.error("获取项目列表失败")}};return Oe(()=>{p.is_deleted=0,n(),Re()}),(u,o)=>{const g=V("el-icon"),m=V("el-button"),z=V("el-tab-pane"),M=V("el-tabs"),x=V("el-input"),F=V("el-option"),T=V("el-select"),E=V("el-table-column"),ve=V("el-tag"),Te=V("el-table"),Ee=V("el-pagination"),K=V("el-form-item"),_e=V("el-upload"),ye=V("el-form"),fe=V("el-dialog"),Ne=V("el-alert"),We=Ye("loading");return C(),W("div",rt,[o[41]||(o[41]=c("div",{class:"page-header"},[c("div",{class:"header-content"},[c("h1",{class:"page-title"},"配置文件管理"),c("div",{class:"page-description"},"管理系统中的配置文件")])],-1)),c("div",st,[c("div",it,[o[22]||(o[22]=c("div",{class:"card-title"},"配置文件列表",-1)),c("div",ut,[s(m,{type:"primary",class:"primary-button",onClick:$},{default:d(()=>[s(g,null,{default:d(()=>[s(B(Je))]),_:1}),o[18]||(o[18]=A("添加配置 "))]),_:1}),s(m,{type:"primary",class:"primary-button",onClick:De},{default:d(()=>[s(g,null,{default:d(()=>[s(B(Ge))]),_:1}),o[19]||(o[19]=A("批量添加 "))]),_:1}),s(m,{type:"primary",class:"primary-button",onClick:w,loading:b.value},{default:d(()=>[s(g,null,{default:d(()=>[s(B(He))]),_:1}),o[20]||(o[20]=A("刷新数据 "))]),_:1},8,["loading"]),s(m,{type:"success",class:"download-button",onClick:Ue,disabled:oe.value.length===0,loading:ie.value},{default:d(()=>[s(g,null,{default:d(()=>[s(B(Ke))]),_:1}),o[21]||(o[21]=A("批量下载 "))]),_:1},8,["disabled","loading"])])]),c("div",dt,[s(M,{modelValue:y.value,"onUpdate:modelValue":o[0]||(o[0]=i=>y.value=i),onTabChange:r},{default:d(()=>[s(z,{label:"正常配置",name:"active"}),s(z,{label:"历史配置",name:"deleted"})]),_:1},8,["modelValue"])]),c("div",ct,[c("div",ft,[o[23]||(o[23]=c("span",{class:"filter-label"},"产品：",-1)),s(x,{modelValue:p.product,"onUpdate:modelValue":o[1]||(o[1]=i=>p.product=i),placeholder:"请输入产品名称",clearable:"",class:"filter-input"},null,8,["modelValue"])]),c("div",pt,[o[24]||(o[24]=c("span",{class:"filter-label"},"项目：",-1)),s(T,{modelValue:p.project,"onUpdate:modelValue":o[2]||(o[2]=i=>p.project=i),placeholder:"请选择项目",clearable:"",filterable:"",class:"filter-input"},{default:d(()=>[(C(!0),W(ge,null,me(Q.value,i=>(C(),O(F,{key:i,label:i,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",gt,[o[25]||(o[25]=c("span",{class:"filter-label"},"文件名：",-1)),s(x,{modelValue:p.filename,"onUpdate:modelValue":o[3]||(o[3]=i=>p.filename=i),placeholder:"请输入文件名",clearable:"",class:"filter-input"},null,8,["modelValue"])]),c("div",mt,[o[26]||(o[26]=c("span",{class:"filter-label"},"标签：",-1)),s(x,{modelValue:p.tag,"onUpdate:modelValue":o[4]||(o[4]=i=>p.tag=i),placeholder:"请输入标签",clearable:"",class:"filter-input"},null,8,["modelValue"])]),c("div",ht,[s(m,{type:"primary",class:"primary-button",onClick:l},{default:d(()=>[s(g,null,{default:d(()=>[s(B(Qe))]),_:1}),o[27]||(o[27]=A("查询 "))]),_:1}),s(m,{onClick:a},{default:d(()=>[s(g,null,{default:d(()=>[s(B(he))]),_:1}),o[28]||(o[28]=A("重置 "))]),_:1})])]),c("div",vt,[Xe((C(),O(Te,{data:J.value,border:"",stripe:"",style:{width:"100%"},"header-cell-style":{backgroundColor:"#f5f7fa",color:"#606266",fontWeight:"bold",textAlign:"center"},"cell-style":{padding:"12px 0"},"highlight-current-row":"",class:"config-table",onSelectionChange:Fe},{default:d(()=>[s(E,{type:"selection",width:"55",align:"center"}),s(E,{label:"ID","min-width":"100",align:"center"},{default:d(i=>[c("span",_t,N(i.$index+1+(D.value-1)*H.value),1)]),_:1}),s(E,{prop:"product",label:"产品","min-width":"120",align:"center"},{default:d(i=>[c("span",yt,N(i.row.product),1)]),_:1}),s(E,{prop:"project",label:"项目","min-width":"120",align:"center"},{default:d(i=>[c("span",bt,N(i.row.project),1)]),_:1}),s(E,{prop:"filename",label:"文件名","min-width":"220",align:"center"},{default:d(i=>[s(m,{type:"success",size:"small",plain:"",class:"action-button",onClick:be=>Me(i.row),disabled:i.row.is_deleted===1,style:{display:"flex","align-items":"center",gap:"6px"}},{default:d(()=>[s(g,null,{default:d(()=>[s(B(Ze))]),_:1}),c("span",null,N(i.row.filename),1)]),_:2},1032,["onClick","disabled"])]),_:1}),s(E,{prop:"tag",label:"标签","min-width":"120",align:"center"},{default:d(i=>[i.row.tag?(C(),O(ve,{key:0,size:"small",effect:"light"},{default:d(()=>[A(N(i.row.tag),1)]),_:2},1024)):(C(),W("span",wt,"-"))]),_:1}),s(E,{prop:"create_time",label:"创建时间","min-width":"180",align:"center"},{default:d(i=>[c("span",Ct,N(i.row.create_time),1)]),_:1}),s(E,{prop:"modify_time",label:"修改时间","min-width":"180",align:"center"},{default:d(i=>[c("span",Vt,N(i.row.modify_time||"-"),1)]),_:1}),s(E,{label:"状态","min-width":"100",align:"center"},{default:d(i=>[s(ve,{type:i.row.is_deleted===0?"success":"danger",effect:"light",class:"custom-tag"},{default:d(()=>[c("div",At,[c("span",jt,N(i.row.is_deleted===0?"正常":"已删除"),1)])]),_:2},1032,["type"])]),_:1}),s(E,{label:"操作","min-width":"200",align:"center",fixed:"right"},{default:d(i=>[c("div",xt,[s(m,{type:"primary",size:"small",plain:"",class:"action-button",onClick:be=>R(i.row),disabled:i.row.is_deleted===1},{default:d(()=>[s(g,null,{default:d(()=>[s(B(ke))]),_:1}),o[29]||(o[29]=c("span",null,"编辑",-1))]),_:2},1032,["onClick","disabled"]),s(m,{type:i.row.is_deleted===0?"danger":"success",size:"small",plain:"",class:"action-button",onClick:be=>ne(i.row)},{default:d(()=>[s(g,null,{default:d(()=>[i.row.is_deleted===0?(C(),O(B(he),{key:0})):(C(),O(B(et),{key:1}))]),_:2},1024),c("span",null,N(i.row.is_deleted===0?"删除":"恢复"),1)]),_:2},1032,["type","onClick"])])]),_:1})]),_:1},8,["data"])),[[We,b.value]]),c("div",Bt,[s(Ee,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:G.value,"page-sizes":[10,20,50,100],"page-size":H.value,"current-page":D.value,onSizeChange:e,onCurrentChange:t},null,8,["total","page-size","current-page"])])])]),s(fe,{title:U.value==="create"?"添加配置文件":"编辑配置文件",modelValue:P.value,"onUpdate:modelValue":o[10]||(o[10]=i=>P.value=i),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:d(()=>[c("span",St,[s(m,{onClick:o[9]||(o[9]=i=>P.value=!1)},{default:d(()=>o[32]||(o[32]=[A("取消")])),_:1}),s(m,{type:"primary",class:"primary-button",onClick:Ae,loading:Z.value},{default:d(()=>o[33]||(o[33]=[A(" 确定 ")])),_:1},8,["loading"])])]),default:d(()=>[s(ye,{ref_key:"configFormRef",ref:X,model:f,rules:h,"label-width":"100px"},{default:d(()=>[s(K,{label:"产品",prop:"product"},{default:d(()=>[s(x,{modelValue:f.product,"onUpdate:modelValue":o[5]||(o[5]=i=>f.product=i),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),s(K,{label:"项目",prop:"project"},{default:d(()=>[s(T,{modelValue:f.project,"onUpdate:modelValue":o[6]||(o[6]=i=>f.project=i),placeholder:"请选择项目",filterable:"","allow-create":"","default-first-option":"",class:"full-width-select"},{default:d(()=>[(C(!0),W(ge,null,me(Q.value,i=>(C(),O(F,{key:i,label:i,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(K,{label:"文件名",prop:"filename"},{default:d(()=>[s(_e,{class:"upload-area",drag:"","auto-upload":!1,multiple:!1,"show-file-list":!1,"on-change":je},{tip:d(()=>o[30]||(o[30]=[c("div",{class:"upload-tip"},"点击或拖拽上传配置文件",-1)])),default:d(()=>[s(g,{class:"upload-icon"},{default:d(()=>[s(B(Ce))]),_:1}),o[31]||(o[31]=c("div",{class:"upload-text"},[A("将文件拖到此处，或"),c("em",null,"点击上传")],-1))]),_:1}),j.value?(C(),W("div",Ft,[c("span",Ut,N(j.value.name),1),s(m,{type:"danger",size:"small",onClick:xe},{default:d(()=>[s(g,null,{default:d(()=>[s(B(he))]),_:1})]),_:1})])):we("",!0),j.value?we("",!0):(C(),O(x,{key:1,modelValue:f.filename,"onUpdate:modelValue":o[7]||(o[7]=i=>f.filename=i),placeholder:"请输入配置文件名"},null,8,["modelValue"]))]),_:1}),s(K,{label:"标签",prop:"tag"},{default:d(()=>[s(x,{modelValue:f.tag,"onUpdate:modelValue":o[8]||(o[8]=i=>f.tag=i),placeholder:"请输入标签（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),s(fe,{title:"批量添加配置文件",modelValue:k.value,"onUpdate:modelValue":o[14]||(o[14]=i=>k.value=i),width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:d(()=>[c("span",$t,[s(m,{onClick:o[13]||(o[13]=i=>k.value=!1)},{default:d(()=>o[36]||(o[36]=[A("取消")])),_:1}),s(m,{type:"primary",class:"primary-button",onClick:ze,loading:ue.value},{default:d(()=>o[37]||(o[37]=[A(" 确定 ")])),_:1},8,["loading"])])]),default:d(()=>[c("div",Dt,[s(ye,{ref_key:"batchFormRef",ref:Se,model:L,"label-width":"100px"},{default:d(()=>[s(K,{label:"项目",prop:"project"},{default:d(()=>[s(T,{modelValue:L.project,"onUpdate:modelValue":o[11]||(o[11]=i=>L.project=i),placeholder:"请选择项目",filterable:"","allow-create":"","default-first-option":"",class:"full-width-select"},{default:d(()=>[(C(!0),W(ge,null,me(Q.value,i=>(C(),O(F,{key:i,label:i,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(K,{label:"标签",prop:"tag"},{default:d(()=>[s(x,{modelValue:L.tag,"onUpdate:modelValue":o[12]||(o[12]=i=>L.tag=i),placeholder:"请输入标签（可选）"},null,8,["modelValue"])]),_:1}),s(K,{label:"配置文件"},{default:d(()=>[s(_e,{class:"batch-upload-area",drag:"","auto-upload":!1,multiple:"","show-file-list":!0,"on-change":$e,"file-list":ee.value,"on-remove":Le},{tip:d(()=>o[34]||(o[34]=[c("div",{class:"upload-tip"},"支持批量上传多个配置文件，文件名格式为：产品名.yaml",-1)])),default:d(()=>[s(g,{class:"upload-icon"},{default:d(()=>[s(B(Ce))]),_:1}),o[35]||(o[35]=c("div",{class:"upload-text"},[A("将文件拖到此处，或"),c("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),s(fe,{title:"编辑配置文件内容",modelValue:ae.value,"onUpdate:modelValue":o[17]||(o[17]=i=>ae.value=i),width:"80%","close-on-click-modal":!1,"destroy-on-close":"",class:"editor-dialog"},{footer:d(()=>[c("span",It,[s(m,{onClick:o[16]||(o[16]=i=>ae.value=!1)},{default:d(()=>o[39]||(o[39]=[A("取消")])),_:1}),s(m,{type:"primary",class:"primary-button",onClick:Ie,loading:ce.value},{default:d(()=>o[40]||(o[40]=[A(" 保存 ")])),_:1},8,["loading"])])]),default:d(()=>[de.value?(C(),W("div",Lt,[s(g,{class:"is-loading"},{default:d(()=>[s(B(tt))]),_:1}),o[38]||(o[38]=c("span",null,"加载文件内容中...",-1))])):Y.value?(C(),W("div",zt,[s(Ne,{title:Y.value,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):(C(),W("div",Mt,[s(x,{modelValue:le.value,"onUpdate:modelValue":o[15]||(o[15]=i=>le.value=i),type:"textarea",rows:28,resize:"none",spellcheck:"false",class:"code-editor"},null,8,["modelValue"])]))]),_:1},8,["modelValue"])])}}}),Nt=lt(Rt,[["__scopeId","data-v-a76888ae"]]);export{Nt as default};
